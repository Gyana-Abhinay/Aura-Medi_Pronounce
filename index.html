<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MediPronounce — Medical Pronunciation Trainer</title>
    <meta name="description" content="Search any English word for audio pronunciation and phonetic transcription. Learn key medical terms with quick play support." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: { DEFAULT: '#0ea5e9', foreground: '#ffffff' }
            },
            fontFamily: { sans: ['Inter', 'ui-sans-serif', 'system-ui', 'sans-serif'] }
          }
        }
      }
    </script>
    <style>html, body { height: 100%; }</style>
  </head>

  <body class="min-h-screen bg-gradient-to-b from-slate-50 to-sky-50 text-slate-900 font-sans">
    <header class="sticky top-0 z-20 border-b bg-white/80 backdrop-blur">
      <div class="mx-auto max-w-6xl px-4 h-16 flex items-center justify-between">
        <a href="#" class="flex items-center gap-2 font-extrabold tracking-tight">
          <span class="inline-flex size-8 items-center justify-center rounded-lg bg-primary text-white">AR</span>
          <span>AURA Pronounce</span>
        </a>
        <nav class="hidden md:flex items-center gap-6 text-sm text-slate-600">
          <a href="#learn" class="hover:text-slate-900">Learn</a>
          <a href="#search" class="hover:text-slate-900">Search</a>
          <a href="#about" class="hover:text-slate-900">About</a>
        </nav>
        <a href="#learn" class="hidden md:inline-flex items-center justify-center h-10 px-4 rounded-md bg-slate-900 text-white hover:bg-slate-800">Start Learning</a>
      </div>
    </header>

    <main class="mx-auto max-w-6xl px-4">
      <section id="search" class="py-14 md:py-20 grid gap-8 md:grid-cols-2 md:gap-12 items-center">
        <div>
          <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight leading-tight">Master Your Pronunciation</h1>
          <p class="mt-4 text-lg text-slate-600">Search any English word to hear its pronunciation and see its phonetic transcription. Built for medical students and language support.</p>
          <form id="search-form" class="mt-6 flex w-full items-center gap-2">
            <div class="relative flex-1">
              <input id="search-input" aria-label="Search word" placeholder="Search any English word…" class="w-full h-12 rounded-md border border-slate-300 bg-white px-3 py-2 pl-10 text-base placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-500" />
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="absolute left-3 top-1/2 -translate-y-1/2 size-5 text-slate-400"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg>
            </div>
            <button type="submit" class="h-12 px-6 rounded-md bg-slate-900 text-white hover:bg-slate-800">Search</button>
          </form>
          <p class="mt-2 text-xs text-slate-500">Tip: If audio is unavailable, your browser voice is used as a fallback.</p>
        </div>
        <div id="result" class="rounded-xl border border-slate-200 bg-white p-6 min-h-[160px]">
          <p class="text-slate-500">Search a word to see results.</p>
        </div>
      </section>

      <section id="learn" class="py-12 md:py-16">
        <div class="flex items-end justify-between gap-4">
          <div>
            <h2 class="text-2xl md:3xl font-bold tracking-tight">Learn medical pronunciations</h2>
            <p class="text-slate-600 mt-1">Curated terms commonly used in medical curricula. Tap play to listen and practice.</p>
          </div>
          <a href="#search" class="text-sm text-sky-600 hover:underline">Search your own →</a>
        </div>
        <div id="learn-grid" class="mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-3"></div>
      </section>

      <section id="about" class="py-12 md:py-20">
        <div class="rounded-2xl border border-slate-200 bg-white p-8 md:p-12">
          <h3 class="text-xl md:text-2xl font-semibold">About this tool</h3>
          <p class="mt-3 text-slate-600">This app helps students accurately pronounce complex terminology. Data is sourced from public dictionary APIs with on-device text-to-speech fallback for accessibility.</p>
        </div>
      </section>
    </main>

    <footer class="border-t border-slate-200">
      <div class="mx-auto max-w-6xl px-4 py-8 text-sm text-slate-600 flex flex-col md:flex-row items-center justify-between gap-2">
        <p>© <span id="year"></span> Department of English, Med School</p>
        <p>Built for learning. <a class="underline hover:no-underline" href="#learn">Get started</a></p>
      </div>
    </footer>

    <script>
      const YEAR_EL = document.getElementById('year');
      YEAR_EL.textContent = new Date().getFullYear();

      const TERMS = [
        'Prophylactic','Lesions','Exaggerated','Eukaryotic','Prokaryotic','Self - luminous','Plotted','Microaerophilic','Capnophilic','Mesophiles','Psychrophiles','Inspissation','Tyndallisation','Germinate','Ketogenesis','Hyperbilirubinemia','Apolipoproteins','Centrifugation','Reagent blank','Calibration','Nephelometry','Spectrophotometer','Hypercholesterolemia','Ubiquinone','Pyramidines','Denaturation','Hypertrophy'
      ];

      function pickBestAudio(phonetics) {
        if (!Array.isArray(phonetics)) return undefined;
        const withAudio = phonetics.filter(p => p && p.audio);
        withAudio.sort((a,b) => {
          const aScore = (a.audio?.startsWith('https')?1:0) + (a.audio?.endsWith('.mp3')?1:0);
          const bScore = (b.audio?.startsWith('https')?1:0) + (b.audio?.endsWith('.mp3')?1:0);
          return bScore - aScore;
        });
        return withAudio[0]?.audio;
      }

      function normalizeWord(input){
        return String(input||'')
          .replace(/[\u2013\u2014]/g, '-')
          .replace(/\s*-\s*/g, '-')
          .replace(/\s+/g, ' ')
          .trim();
      }

      async function tryDictionary(locale, q){
        const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/${locale}/` + encodeURIComponent(q));
        if (!res.ok) return null;
        const json = await res.json();
        if (!Array.isArray(json) || json.length === 0) return null;
        const entry = json[0];
        const phonetics = new Set();
        if (entry.phonetic) phonetics.add(entry.phonetic);
        (entry.phonetics||[]).forEach(p=>{ if(p && p.text) phonetics.add(p.text); });
        const audioUrl = pickBestAudio(entry.phonetics);
        return { word: entry.word, phonetics: Array.from(phonetics), audioUrl, meanings: entry.meanings||[] };
      }

      async function fetchWord(word) {
        const q = normalizeWord(word);
        if (!q) return null;
        const locales = ['en', 'en_US', 'en_GB'];
        for (const loc of locales){
          try {
            const res = await tryDictionary(loc, q);
            if (res) return res;
          } catch (_) {}
        }
        return { word: q, phonetics: [], audioUrl: null, meanings: [] };
      }

      function speak(text){
        if (!('speechSynthesis' in window)) return;
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'en-US';
        speechSynthesis.speak(u);
      }

      function renderResult(container, data, loading){
        if (loading) {
          container.innerHTML = '<div class="flex items-center gap-3 text-slate-500"><svg class="animate-spin" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg> Fetching pronunciation…</div>';
          return;
        }
        if (!data) {
          container.innerHTML = '<p class="text-slate-500">No results. Try another word.</p>';
          return;
        }
        const phonTags = (data.phonetics||[]).map(p=>`<span class=\"rounded bg-sky-100 text-sky-900 px-2 py-0.5 text-sm\">${p}</span>`).join('');
        const defs = (data.meanings||[]).slice(0,2).map(m=>{
          const badge = m.partOfSpeech ? `<span class=\"mr-2 rounded border px-1.5 py-0.5 text-xs uppercase tracking-wide\">${m.partOfSpeech}</span>` : '';
          const def = (m.definitions && m.definitions[0] && m.definitions[0].definition) || '';
          return `<div class=\"text-sm text-slate-600\">${badge}${def}</div>`;
        }).join('');
        container.innerHTML = `
          <div class=\"space-y-4\">
            <div class=\"flex items-start justify-between gap-4\">
              <div>
                <h2 class=\"text-2xl font-bold tracking-tight\">${data.word}</h2>
                <div class=\"mt-1 flex flex-wrap items-center gap-2 text-sky-800\">${phonTags}</div>
              </div>
              <button id=\"play-main\" class=\"inline-flex items-center gap-2 h-10 px-3 rounded-md bg-slate-100 hover:bg-slate-200\">
                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\"></polygon><path d=\"M19 5v14\"></path><path d=\"M23 10v4\"></path></svg>
                Play
              </button>
            </div>
            ${defs}
            ${data.audioUrl ? `<audio id=\"audio-main\" src=\"${data.audioUrl}\" class=\"w-full mt-2\" controls></audio>` : ''}
          </div>`;
        const btn = container.querySelector('#play-main');
        btn?.addEventListener('click', () => {
          const audio = container.querySelector('#audio-main');
          if (audio) { audio.currentTime = 0; audio.play(); } else { speak(data.word); }
        });
      }

      const resultEl = document.getElementById('result');
      const form = document.getElementById('search-form');
      const input = document.getElementById('search-input');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const q = input.value;
        const norm = normalizeWord(q);
        if (!norm) return;
        renderResult(resultEl, null, true);
        const data = await fetchWord(norm);
        renderResult(resultEl, data, false);
      });

      const grid = document.getElementById('learn-grid');
      TERMS.forEach((term) => {
        const card = document.createElement('div');
        card.className = 'group rounded-xl border border-slate-200 bg-white p-5 transition hover:shadow-md';
        card.innerHTML = `
          <div class=\"flex items-start justify-between gap-3\">
            <div>
              <h3 class=\"text-lg font-semibold leading-none tracking-tight\">${term}</h3>
              <p class=\"mt-1 text-sm text-sky-800 min-h-5\">Loading…</p>
            </div>
            <button class=\"play inline-flex items-center gap-2 h-9 px-3 rounded-md bg-slate-100 hover:bg-slate-200\">
              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\"></polygon><path d=\"M19 5v14\"></path><path d=\"M23 10v4\"></path></svg>
              Play
            </button>
          </div>
        `;
        grid.appendChild(card);
        const phoneticEl = card.querySelector('p');
        const playBtn = card.querySelector('button.play');
        let audioUrl = null;
        fetchWord(term).then(data => {
          if (!data) { phoneticEl.textContent = ''; return; }
          phoneticEl.textContent = data.phonetics && data.phonetics[0] ? data.phonetics[0] : '';
          audioUrl = data.audioUrl || null;
        });
        playBtn.addEventListener('click', () => {
          if (audioUrl) {
            const a = new Audio(audioUrl);
            a.play();
          } else {
            speak(term);
          }
        });
      });
    </script>
  </body>
</html>
